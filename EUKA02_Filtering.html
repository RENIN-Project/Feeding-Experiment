<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.256">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stefaniya Kamenova">
<meta name="author" content="Pernille Meyer">
<meta name="author" content="Anne Krag Brysting">
<meta name="author" content="Leo Rescia">
<meta name="author" content="Lars P. Folkow">
<meta name="author" content="Galina Gusarova">
<meta name="author" content="Eric Coissac">

<title>DNA metabarcoding diet analysis in reindeer is quantitative and integrates feeding over several weeks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="EUKA02_Filtering_files/libs/clipboard/clipboard.min.js"></script>
<script src="EUKA02_Filtering_files/libs/quarto-html/quarto.js"></script>
<script src="EUKA02_Filtering_files/libs/quarto-html/popper.min.js"></script>
<script src="EUKA02_Filtering_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="EUKA02_Filtering_files/libs/quarto-html/anchor.min.js"></script>
<link href="EUKA02_Filtering_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="EUKA02_Filtering_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="EUKA02_Filtering_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="EUKA02_Filtering_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="EUKA02_Filtering_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><p>DNA metabarcoding diet analysis in reindeer is quantitative and integrates feeding over several weeks</p></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    Stefaniya Kamenova <a href="https://orcid.org/0000-0002-7241-0506" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Centre for Ecological and Evolutionary Synthesis, University of Oslo</p>
          <p></p>
        <p class="affiliation">
            </p><p>Departments of Ecology and Natural Resource Management, Norwegian University of Life Sciences</p>
          <p></p>
        <p class="affiliation">
            </p><p>National Museum of Natural History, Bulgarian Academy of Sciences</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Pernille Meyer 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Centre for Ecological and Evolutionary Synthesis, University of Oslo</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Anne Krag Brysting 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Centre for Ecological and Evolutionary Synthesis, University of Oslo</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Leo Rescia 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Department of Arctic and Marine Biology, The Arctic University of Norway</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Lars P. Folkow 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Department of Arctic and Marine Biology, The Arctic University of Norway</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Galina Gusarova 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Centre for Ecological and Evolutionary Synthesis, University of Oslo</p>
          <p></p>
        <p class="affiliation">
            </p><p>Department of Arctic and Marine Biology, The Arctic University of Norway</p>
          <p></p>
        <p class="affiliation">
            </p><p>The Arctic University Museum of Norway, The Arctic University of Norway</p>
          <p></p>
        <p class="affiliation">
            </p><p>Department of Botany, St Petersburg State University</p>
          <p></p>
      </div>
      <div class="quarto-title-meta-contents">
    Eric Coissac <a href="https://orcid.org/0000-0001-7507-6729" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            </p><p>Laboratoire d’Ecologie Alpine, CNRS, Université Grenoble Alpes</p>
          <p></p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>Filtering of the EUKA02 DNA metabarcoding raw data.</p>
  </div>
</div>

</header>

<section id="setting-up-the-r-environment" class="level1">
<h1>Setting up the R environment</h1>
<section id="install-missing-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-missing-packages">Install missing packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"igraph"</span>, <span class="st">"tidyverse"</span>, <span class="st">"devtools"</span>,<span class="st">"R.utils"</span>,<span class="st">"vegan"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">setdiff</span>(packages,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dependencies =</span> <span class="cn">TRUE</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-of-the-r-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-of-the-r-libraries">Loading of the R libraries</h2>
<ul>
<li><p><code>ROBITools</code> package is used to read result files produced by OBITools.</p></li>
<li><p><code>ROBITaxonomy</code> package provides function allowing to query OBITools formated taxonomy.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">"ROBITools"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ROBITools are not available on CRAN and have to be installed</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># from http://git.metabarcoding.org using devtools</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  metabarcoding_git <span class="ot">&lt;-</span> <span class="st">"https://git.metabarcoding.org/obitools"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_git</span>(<span class="fu">paste</span>(metabarcoding_git,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ROBIUtils.git"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sep=</span><span class="st">"/"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_git</span>(<span class="fu">paste</span>(metabarcoding_git,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ROBITaxonomy.git"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sep=</span><span class="st">"/"</span>))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_git</span>(<span class="fu">paste</span>(metabarcoding_git,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ROBITools.git"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sep=</span><span class="st">"/"</span>))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROBITools)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROBITaxonomy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>tidyverse</code> <span class="citation" data-cites="Wickham2019-ra">(<a href="#ref-Wickham2019-ra" role="doc-biblioref">Wickham et al., 2019</a>)</span> provides various method for efficient data manipulation and plotting via <code>ggplot2</code> <span class="citation" data-cites="Wickham2016-vl">(<a href="#ref-Wickham2016-vl" role="doc-biblioref">Wickham, 2016</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R.utils)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span> <span class="fu">file.exists</span>(<span class="st">"Data/ncbi20210212.adx"</span>)) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gunzip</span>(<span class="st">"Data/ncbi20210212.adx.gz"</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gunzip</span>(<span class="st">"Data/ncbi20210212.ndx.gz"</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gunzip</span>(<span class="st">"Data/ncbi20210212.rdx.gz"</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gunzip</span>(<span class="st">"Data/ncbi20210212.tdx.gz"</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="loading-the-data" class="level1">
<h1>Loading the data</h1>
<section id="load-the-ncbi-taxonomy" class="level2">
<h2 class="anchored" data-anchor-id="load-the-ncbi-taxonomy">Load the NCBI taxonomy</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>taxo <span class="ot">&lt;-</span> <span class="fu">read.taxonomy</span>(<span class="st">"Data/ncbi20210212"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-metabarcoding-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-metabarcoding-data">Loading the metabarcoding data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span> <span class="fu">file.exists</span>(<span class="st">"Data/Rawdata/EUKA02_all_paired.ali.assigned.ann.diag.uniq.ann.c1.l10.clean.EMBL.tag.ann.sort.uniq.grep.tab"</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gunzip</span>(<span class="st">"Data/Rawdata/EUKA02_all_paired.ali.assigned.ann.diag.uniq.ann.c1.l10.clean.EMBL.tag.ann.sort.uniq.grep.tab.gz"</span>,<span class="at">remove=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>EUKA02.raw <span class="ot">=</span> <span class="fu">import.metabarcoding.data</span>(<span class="st">"Data/Rawdata/EUKA02_all_paired.ali.assigned.ann.diag.uniq.ann.c1.l10.clean.EMBL.tag.ann.sort.uniq.grep.tab"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-metadata" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-metadata">Loading the metadata</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>samples.metadata <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"Data/Faeces/sampling_dates.csv"</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sample-description" class="level1">
<h1>Sample description</h1>
<p>Normalization of samples names</p>
<p>Extract information relative to PCR replicates and sample names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sample_names_split <span class="ot">=</span> <span class="fu">strsplit</span>(<span class="fu">as.character</span>(sample_names), <span class="st">"_R"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>replicate <span class="ot">=</span> <span class="fu">sapply</span>(sample_names_split, <span class="cf">function</span>(x) x[<span class="fu">length</span>(x)])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>sample_id <span class="ot">=</span> <span class="fu">sapply</span>(sample_names_split, <span class="cf">function</span>(x) x[<span class="dv">1</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>samples_desc <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">name =</span> <span class="fu">samples</span>(EUKA02.raw)<span class="sc">$</span>sample, <span class="at">replicate =</span> replicate, <span class="at">sample_id =</span> sample_id)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>EUKA02.raw<span class="sc">@</span>samples <span class="ot">=</span> samples_desc</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>EUKA02.raw<span class="sc">@</span>motus <span class="ot">&lt;-</span> EUKA02.raw<span class="sc">@</span>motus <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"obiclean_status:"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="categorize-motus" class="level2">
<h2 class="anchored" data-anchor-id="categorize-motus">Categorize MOTUs</h2>
<p>DNA Sequence of the synthetic sequence used as EUKA02 positive controls.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Standard1 <span class="ot">=</span> <span class="st">"taagtctcgcactagttgtgacctaacgaatagagaattctataagacgtgttgtcccat"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Identify which MOTU is corresponding to the positive control sequence and associated it to category <code>standard1</code>.</li>
<li>All the MOTUs exhibiting a similarity with one of the reference SPER01 database greater than 80% is tagged as <code>EUKA02</code></li>
<li>The remaining sequences are tagged as <code>Unknown</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sequence_type <span class="ot">=</span> <span class="fu">rep</span>(<span class="st">"Unknown"</span>, <span class="fu">nrow</span>(<span class="fu">motus</span>(EUKA02.raw)))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sequence_type[<span class="fu">which</span>(<span class="fu">motus</span>(EUKA02.raw)<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span><span class="sc">&gt;</span> <span class="fl">0.80</span>)] <span class="ot">=</span> <span class="st">"EUKA02"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>sequence_type[<span class="fu">which</span>(<span class="fu">motus</span>(EUKA02.raw)<span class="sc">$</span>sequence <span class="sc">==</span> Standard1)] <span class="ot">=</span> <span class="st">"standard1"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>sequence_type <span class="ot">=</span> <span class="fu">as.factor</span>(sequence_type)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>sequence_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 EUKA02 Unknown 
 252502  223912 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>spermatophyta.taxid <span class="ot">&lt;-</span> <span class="fu">ecofind</span>(taxo,<span class="at">patterns =</span> <span class="st">"^Spermatophyta$"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fungi.taxid <span class="ot">&lt;-</span> <span class="fu">ecofind</span>(taxo,<span class="at">patterns =</span> <span class="st">"^Fungi$"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>to_keep <span class="ot">=</span> (<span class="fu">is.subcladeof</span>(taxo,EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>taxid,spermatophyta.taxid) <span class="sc">|</span> EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>taxid <span class="sc">==</span> spermatophyta.taxid) <span class="sc">|</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           (<span class="fu">is.subcladeof</span>(taxo,EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>taxid,fungi.taxid) <span class="sc">|</span> EUKA02.raw<span class="sc">@</span>motus<span class="sc">$</span>taxid <span class="sc">==</span> fungi.taxid)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(to_keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>to_keep
 FALSE   TRUE 
394532  81351 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>EUKA02.plant_fungi <span class="ot">&lt;-</span> EUKA02.raw[,<span class="fu">which</span>(to_keep)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="curation-procedure" class="level1">
<h1>Curation procedure</h1>
<section id="select-motus-occuring-at-least-at-1-in-at-least-one-pcr" class="level2">
<h2 class="anchored" data-anchor-id="select-motus-occuring-at-least-at-1-in-at-least-one-pcr">Select motus occuring at least at 1% in at least one PCR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>norare <span class="ot">=</span> <span class="fu">apply</span>(<span class="fu">decostand</span>(<span class="fu">reads</span>(EUKA02.plant_fungi),<span class="at">method =</span> <span class="st">"total"</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">MARGIN =</span> <span class="dv">2</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">FUN =</span> max) <span class="sc">&gt;=</span> <span class="fl">0.01</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(norare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>norare
FALSE  TRUE 
81023   328 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>EUKA02.norare <span class="ot">&lt;-</span> EUKA02.plant_fungi[,<span class="fu">which</span>(norare)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filtering-for-pcr-outliers" class="level2">
<h2 class="anchored" data-anchor-id="filtering-for-pcr-outliers">Filtering for PCR outliers</h2>
<p>Only library 1 and 2 have individually tagged PCR replicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>library_3.ids <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"Data/samples_library_3.txt"</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">header =</span> <span class="cn">FALSE</span>)[,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>library3.keep <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">"_R.?$"</span>,<span class="st">"_R"</span>,<span class="fu">rownames</span>(EUKA02.norare)) <span class="sc">%in%</span> library_3.ids</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>EUKA02.lib3 <span class="ot">=</span> EUKA02.norare[library3.keep,]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12<span class="ot">=</span> EUKA02.norare[<span class="sc">!</span>library3.keep,]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(EUKA02.lib3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  63 328</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(EUKA02.lib12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 542 328</code></pre>
</div>
</div>
<p>Load the script containing the selection procedure implemented in function <code>tag_bad_pcr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Select_PCR.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="first-selection-round" class="level3">
<h3 class="anchored" data-anchor-id="first-selection-round">First selection round</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>keep1 <span class="ot">=</span> <span class="fu">tag_bad_pcr</span>(<span class="at">samples =</span> <span class="fu">samples</span>(EUKA02.lib12)<span class="sc">$</span>sample_id, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">counts =</span> <span class="fu">reads</span>(EUKA02.lib12),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">threshold=</span><span class="fl">0.2</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Histogram shows the empirical distribution of the PCR replicate distances. The red vertical dashed line indicates the threshold used to discard outlier PCRs. The green vertical dashed line indicates the mode of the observed distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(keep1<span class="sc">$</span>keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   49   493 </code></pre>
</div>
</div>
<p><code>FALSE</code>is the count of PCR to discard, <code>TRUE</code> the count of PCR conserved at the end of this selection round.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">samples</span>(EUKA02.lib12)<span class="sc">$</span>name[<span class="sc">!</span>keep1<span class="sc">$</span>keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DNANC11_R3"  "DNANC12_R3"  "DNANC13_R3"  "DNANC14_R3"  "DNANC15_R3" 
 [6] "DNANC_10_R2" "DNANC_12_R3" "DNANC_13_R3" "DNANC_14_R3" "DNANC_15_R3"
[11] "DNANC_7_R2"  "DNANC_8_R2"  "DNANC_9_R2"  "PCRNC_3_R2"  "PCRNC_4_R1" 
[16] "PCRNC_4_R2"  "PCRNC_5_R3"  "PCRNC_6_R3"  "PCRPOS_3_R2" "X_37_R3"    
[21] "X_3_R3"      "X_50_R2"     "X_9_R3"      "Y_24_R3"     "Y_29_R2"    
[26] "Y_2_R1"      "Y_33_R2"     "Y_36_R2"     "Y_44_R3"     "Y_45_R3"    
[31] "Y_46_R3"     "Y_47_R3"     "Y_48_R2"     "Y_49_R2"     "Y_51_R2"    
[36] "Y_52_R1"     "Y_56_R1"     "Y_5_R1"      "Y_7_R2"      "Y_8_R1"     
[41] "Z_12_R3"     "Z_21_R2"     "Z_30_R1"     "Z_33_R3"     "Z_45_R3"    
[46] "Z_49_R1"     "Z_51_R2"     "Z_53_R2"     "Z_5_R2"     </code></pre>
</div>
</div>
<p>Above is the list of the ids of the discarded PCRs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12.k1 <span class="ot">=</span> EUKA02.lib12[keep1<span class="sc">$</span>keep,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="second-selection-round" class="level3">
<h3 class="anchored" data-anchor-id="second-selection-round">Second selection round</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>keep2 <span class="ot">=</span> <span class="fu">tag_bad_pcr</span>(<span class="at">samples =</span> <span class="fu">samples</span>(EUKA02.lib12.k1)<span class="sc">$</span>sample_id, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">counts =</span> <span class="fu">reads</span>(EUKA02.lib12.k1),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">threshold=</span><span class="fl">0.2</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(keep2<span class="sc">$</span>keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   20   473 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">samples</span>(EUKA02.lib12.k1)<span class="sc">$</span>name[<span class="sc">!</span>keep2<span class="sc">$</span>keep]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Y_29_R1" "Y_29_R3" "Y_2_R3"  "Y_33_R3" "Y_36_R1" "Y_44_R1" "Y_44_R2"
 [8] "Y_46_R1" "Y_46_R2" "Y_47_R1" "Y_47_R2" "Y_49_R1" "Y_49_R3" "Y_51_R3"
[15] "Z_30_R2" "Z_30_R3" "Z_33_R1" "Z_33_R2" "Z_53_R1" "Z_53_R3"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12.k2 <span class="ot">=</span> EUKA02.lib12.k1[keep2<span class="sc">$</span>keep,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="third-selection-round" class="level3">
<h3 class="anchored" data-anchor-id="third-selection-round">Third selection round</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>keep3 <span class="ot">=</span> <span class="fu">tag_bad_pcr</span>(<span class="at">samples =</span> <span class="fu">samples</span>(EUKA02.lib12.k2)<span class="sc">$</span>sample_id, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">counts =</span> <span class="fu">reads</span>(EUKA02.lib12.k2),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">threshold=</span><span class="fl">0.2</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(keep3<span class="sc">$</span>keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    4   469 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>keep3[<span class="sc">!</span>keep3<span class="sc">$</span>keep,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        samples distance maximum repeats  keep
Y_2_R2      Y_2        0       0       1 FALSE
Y_33_R1    Y_33        0       0       1 FALSE
Y_36_R3    Y_36        0       0       1 FALSE
Y_51_R1    Y_51        0       0       1 FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12.k3 <span class="ot">=</span> EUKA02.lib12.k2[keep3<span class="sc">$</span>keep,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="merge-remaining-pcr-replicates" class="level3">
<h3 class="anchored" data-anchor-id="merge-remaining-pcr-replicates">Merge remaining PCR replicates</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>freq <span class="ot">=</span> <span class="fu">decostand</span>(<span class="fu">reads</span>(EUKA02.lib12.k3),</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"total"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12.k3<span class="sc">$</span>count <span class="ot">=</span> <span class="fu">reads</span>(EUKA02.lib12.k3)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>EUKA02.lib12.k3<span class="sc">@</span>reads <span class="ot">=</span> freq</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>EUKA02.merged <span class="ot">=</span> <span class="fu">aggregate</span>(EUKA02.lib12.k3, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fu">list</span>(<span class="at">sample_id=</span><span class="fu">samples</span>(EUKA02.lib12.k3)<span class="sc">$</span>sample_id), <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="merge-lib-12-and-3" class="level2">
<h2 class="anchored" data-anchor-id="merge-lib-12-and-3">Merge lib 1,2 and 3</h2>
<section id="remove-controls-in-library-3" class="level3">
<h3 class="anchored" data-anchor-id="remove-controls-in-library-3">Remove controls in library 3</h3>
<p>Look for controls left in library 1 and 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(EUKA02.merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "X_10" "X_11" "X_12" "X_14" "X_15" "X_16" "X_17" "X_18" "X_19" "X_2" 
 [11] "X_20" "X_21" "X_22" "X_23" "X_24" "X_25" "X_26" "X_27" "X_28" "X_29"
 [21] "X_3"  "X_30" "X_31" "X_33" "X_34" "X_35" "X_36" "X_37" "X_38" "X_39"
 [31] "X_4"  "X_41" "X_42" "X_44" "X_50" "X_51" "X_53" "X_54" "X_56" "X_57"
 [41] "X_59" "X_60" "X_63" "X_64" "X_65" "X_66" "X_68" "X_70" "X_74" "X_75"
 [51] "X_76" "X_77" "X_78" "X_79" "X_80" "X_9"  "Y_1"  "Y_11" "Y_13" "Y_14"
 [61] "Y_18" "Y_21" "Y_23" "Y_24" "Y_25" "Y_26" "Y_28" "Y_3"  "Y_31" "Y_32"
 [71] "Y_34" "Y_38" "Y_39" "Y_4"  "Y_40" "Y_41" "Y_42" "Y_43" "Y_45" "Y_5" 
 [81] "Y_50" "Y_52" "Y_53" "Y_56" "Y_57" "Y_58" "Y_59" "Y_6"  "Y_61" "Y_69"
 [91] "Y_7"  "Y_70" "Y_71" "Y_72" "Y_74" "Y_8"  "Y_9"  "Z_1"  "Z_10" "Z_11"
[101] "Z_12" "Z_13" "Z_14" "Z_15" "Z_16" "Z_17" "Z_18" "Z_19" "Z_20" "Z_21"
[111] "Z_22" "Z_23" "Z_24" "Z_25" "Z_27" "Z_28" "Z_3"  "Z_31" "Z_32" "Z_34"
[121] "Z_35" "Z_36" "Z_37" "Z_38" "Z_4"  "Z_40" "Z_42" "Z_43" "Z_44" "Z_45"
[131] "Z_46" "Z_48" "Z_49" "Z_5"  "Z_51" "Z_52" "Z_54" "Z_55" "Z_56" "Z_59"
[141] "Z_6"  "Z_60" "Z_61" "Z_62" "Z_63" "Z_65" "Z_66" "Z_67" "Z_68" "Z_69"
[151] "Z_7"  "Z_70" "Z_71" "Z_72" "Z_73" "Z_74" "Z_75" "Z_76" "Z_77" "Z_78"
[161] "Z_79" "Z_8"  "Z_80"</code></pre>
</div>
</div>
</section>
</section>
<section id="remove-controls-in-library-3-1" class="level2">
<h2 class="anchored" data-anchor-id="remove-controls-in-library-3-1">Remove controls in library 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(EUKA02.lib3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DNANC_1_R1"  "DNANC_2_R1"  "DNANC_3_R1"  "DNANC_4_R1"  "DNANC_5_R1" 
 [6] "DNANC_6_R1"  "DNANC_6_R2"  "PCRNC_1_R1"  "PCRNC_2_R1"  "PCRPOS_2_R1"
[11] "X_1_R1"      "X_32_R1"     "X_40_R1"     "X_43_R1"     "X_45_R1"    
[16] "X_46_R1"     "X_47_R1"     "X_48_R1"     "X_49_R1"     "X_52_R1"    
[21] "X_55_R1"     "X_58_R1"     "X_5_R1"      "X_62_R1"     "X_67_R1"    
[26] "X_69_R1"     "X_6_R1"      "X_71_R1"     "X_72_R1"     "X_73_R1"    
[31] "X_7_R1"      "X_8_R1"      "Y_10_R1"     "Y_12_R1"     "Y_15_R1"    
[36] "Y_16_R1"     "Y_17_R1"     "Y_19_R1"     "Y_20_R1"     "Y_22_R1"    
[41] "Y_27_R1"     "Y_35_R1"     "Y_37_R1"     "Y_54_R1"     "Y_55_R1"    
[46] "Y_60_R1"     "Y_62_R1"     "Y_63_R1"     "Y_64_R1"     "Y_65_R1"    
[51] "Y_66_R1"     "Y_67_R1"     "Y_68_R1"     "Y_73_R1"     "Z_26_R1"    
[56] "Z_29_R1"     "Z_2_R1"      "Z_41_R1"     "Z_47_R1"     "Z_50_R1"    
[61] "Z_57_R1"     "Z_58_R1"     "Z_9_R1"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib3.samples <span class="ot">=</span> EUKA02.lib3[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),]</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(EUKA02.lib3.samples<span class="sc">@</span>reads) <span class="ot">=</span> <span class="fu">sub</span>(<span class="st">"_R.?$"</span>,<span class="st">""</span>,<span class="fu">rownames</span>(EUKA02.lib3.samples))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(EUKA02.lib3.samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X_1"  "X_32" "X_40" "X_43" "X_45" "X_46" "X_47" "X_48" "X_49" "X_52"
[11] "X_55" "X_58" "X_5"  "X_62" "X_67" "X_69" "X_6"  "X_71" "X_72" "X_73"
[21] "X_7"  "X_8"  "Y_10" "Y_12" "Y_15" "Y_16" "Y_17" "Y_19" "Y_20" "Y_22"
[31] "Y_27" "Y_35" "Y_37" "Y_54" "Y_55" "Y_60" "Y_62" "Y_63" "Y_64" "Y_65"
[41] "Y_66" "Y_67" "Y_68" "Y_73" "Z_26" "Z_29" "Z_2"  "Z_41" "Z_47" "Z_50"
[51] "Z_57" "Z_58" "Z_9" </code></pre>
</div>
</div>
<section id="merge-library-1-2-and-3" class="level3">
<h3 class="anchored" data-anchor-id="merge-library-1-2-and-3">Merge library 1, 2 and 3</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib123.reads <span class="ot">=</span> <span class="fu">rbind</span>(EUKA02.merged<span class="sc">@</span>reads,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">decostand</span>(EUKA02.lib3.samples<span class="sc">@</span>reads,<span class="at">method =</span> <span class="st">"total"</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>common <span class="ot">=</span> <span class="fu">intersect</span>(<span class="fu">names</span>(EUKA02.merged<span class="sc">@</span>samples),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">names</span>(EUKA02.lib3.samples<span class="sc">@</span>samples))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>EUKA02.lib123.samples <span class="ot">=</span> <span class="fu">rbind</span>(EUKA02.merged<span class="sc">@</span>samples[,common],</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                          EUKA02.lib3.samples<span class="sc">@</span>samples[,common])</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>EUKA02.lib123 <span class="ot">=</span> <span class="fu">metabarcoding.data</span>(<span class="at">reads =</span> <span class="fu">decostand</span>(EUKA02.lib123.reads,<span class="at">method =</span> <span class="st">"total"</span>),</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">samples =</span> EUKA02.lib123.samples,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">motus =</span> EUKA02.merged<span class="sc">@</span>motus)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(EUKA02.lib123)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 216 328</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>EUKA02.lib123<span class="sc">@</span>samples<span class="sc">$</span>animal_id <span class="ot">=</span> <span class="fu">sapply</span>(EUKA02.lib123<span class="sc">@</span>samples<span class="sc">$</span>sample_id, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                                <span class="cf">function</span>(x) <span class="fu">strsplit</span>(<span class="fu">as.character</span>(x),<span class="st">"_"</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-for-empty-motus" class="level3">
<h3 class="anchored" data-anchor-id="check-for-empty-motus">Check for empty MOTUs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>zero <span class="ot">=</span> <span class="fu">colSums</span>(<span class="fu">reads</span>(EUKA02.lib123)) <span class="sc">==</span> <span class="dv">0</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(zero)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>zero
FALSE  TRUE 
  265    63 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>EUKA02.nozero <span class="ot">=</span> EUKA02.lib123[,<span class="sc">!</span>zero]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="filter-out-rare-species" class="level1">
<h1>Filter out rare species</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(EUKA02.nozero<span class="sc">@</span>motus<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span>,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">apply</span>(<span class="fu">reads</span>(EUKA02.nozero),<span class="dv">2</span>,max),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">as.factor</span>(EUKA02.nozero<span class="sc">@</span>motus<span class="sc">$</span>sequence_type),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">log=</span><span class="st">"y"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"max read fequency in a sample"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"best identity with the reference database"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.01</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.95</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>EUKA02.merged3 <span class="ot">=</span> EUKA02.lib123[, <span class="fu">apply</span>(<span class="fu">reads</span>(EUKA02.lib123),<span class="dv">2</span>,max) <span class="sc">&gt;</span> <span class="fl">0.01</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(EUKA02.merged3<span class="sc">$</span>motus<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">apply</span>(<span class="fu">reads</span>(EUKA02.merged3),<span class="dv">2</span>,max),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">as.factor</span>(EUKA02.merged3<span class="sc">$</span>motus<span class="sc">$</span>sequence_type),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">log=</span><span class="st">"y"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"max read fequency in a sample"</span>,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"best identity with the reference database"</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.01</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">0.95</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="keep-only-motus-strictly-identical-to-one-of-the-reference-sequence" class="level2">
<h2 class="anchored" data-anchor-id="keep-only-motus-strictly-identical-to-one-of-the-reference-sequence">Keep only MOTUs Strictly identical to one of the reference sequence</h2>
<section id="first-level-stringency-filter-95-identity" class="level3">
<h3 class="anchored" data-anchor-id="first-level-stringency-filter-95-identity">First level stringency filter (95% identity)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4 <span class="ot">=</span> EUKA02.merged3[,EUKA02.merged3<span class="sc">@</span>motus<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">0.95</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4<span class="sc">@</span>reads <span class="ot">=</span> <span class="fu">decostand</span>(EUKA02.merged4<span class="sc">@</span>reads,<span class="at">method =</span> <span class="st">"total"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4<span class="sc">@</span>motus <span class="ot">&lt;-</span> EUKA02.merged4<span class="sc">@</span>motus <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"obiclean_status:"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(EUKA02.merged4<span class="sc">$</span>motus<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span>,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">apply</span>(<span class="fu">reads</span>(EUKA02.merged4),<span class="dv">2</span>,max),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">as.factor</span>(EUKA02.merged4<span class="sc">$</span>motus<span class="sc">$</span>sequence_type),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">log=</span><span class="st">"y"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"max read fequency in a sample"</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"best identity with the reference database"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.01</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="EUKA02_Filtering_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="high-stringency-filtering" class="level3">
<h3 class="anchored" data-anchor-id="high-stringency-filtering">High stringency filtering</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>spermatophyta.taxid <span class="ot">&lt;-</span> <span class="fu">ecofind</span>(taxo,<span class="at">patterns =</span> <span class="st">"^Spermatophyta$"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4<span class="sc">@</span>motus<span class="sc">$</span>is_spermatophyta <span class="ot">&lt;-</span> <span class="fu">is.subcladeof</span>(taxo,EUKA02.merged4<span class="sc">@</span>motus<span class="sc">$</span>taxid,spermatophyta.taxid)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(EUKA02.merged4<span class="sc">@</span>motus<span class="sc">$</span>is_spermatophyta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   66    26 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4<span class="sc">@</span>motus <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>is_spermatophyta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             id definition best_identity:db_EUKA
EUKAP2_00000044 EUKAP2_00000044                        0.9711538
EUKAP2_00000018 EUKAP2_00000018                        0.9898990
EUKAP1_00000465 EUKAP1_00000465                        0.9898990
EUKAP1_00000186 EUKAP1_00000186                        0.9898990
EUKAP1_00000177 EUKAP1_00000177                        1.0000000
EUKAP1_00000039 EUKAP1_00000039                        0.9900000
EUKAP1_00000072 EUKAP1_00000072                        0.9900000
EUKAP1_00000459 EUKAP1_00000459                        0.9898990
EUKAP2_00000193 EUKAP2_00000193                        1.0000000
EUKAP1_00000329 EUKAP1_00000329                        1.0000000
EUKAP1_00000033 EUKAP1_00000033                        1.0000000
EUKAP2_00000191 EUKAP2_00000191                        0.9900000
EUKAP2_00000095 EUKAP2_00000095                        0.9898990
EUKAP1_00000206 EUKAP1_00000206                        1.0000000
EUKAP1_00000011 EUKAP1_00000011                        0.9898990
EUKAP1_00000092 EUKAP1_00000092                        0.9900000
EUKAP1_00001538 EUKAP1_00001538                        0.9898990
EUKAP1_00000188 EUKAP1_00000188                        0.9898990
EUKAP2_00001219 EUKAP2_00001219                        1.0000000
EUKAP1_00000190 EUKAP1_00000190                        0.9898990
EUKAP2_00000008 EUKAP2_00000008                        0.9900000
EUKAP1_00000085 EUKAP1_00000085                        0.9797980
EUKAP2_00001065 EUKAP2_00001065                        1.0000000
EUKAP2_00001127 EUKAP2_00001127                        0.9801980
EUKAP1_00000357 EUKAP1_00000357                        0.9898990
EUKAP1_00003304 EUKAP1_00003304                        0.9696970
EUKAP2_00002016 EUKAP2_00002016                        1.0000000
EUKAP1_00000811 EUKAP1_00000811                        0.9797980
EUKAP1_00000713 EUKAP1_00000713                        0.9898990
EUKAP2_00001304 EUKAP2_00001304                        0.9900000
EUKAP1_00000035 EUKAP1_00000035                        0.9898990
EUKAP1_00000326 EUKAP1_00000326                        1.0000000
EUKAP1_00001471 EUKAP1_00001471                        1.0000000
EUKAP1_00000406 EUKAP1_00000406                        0.9797980
EUKAP1_00001769 EUKAP1_00001769                        0.9901961
EUKAP1_00000362 EUKAP1_00000362                        1.0000000
EUKAP1_00004847 EUKAP1_00004847                        0.9898990
EUKAP2_00001858 EUKAP2_00001858                        0.9900990
EUKAP2_00002179 EUKAP2_00002179                        0.9900990
EUKAP1_00000828 EUKAP1_00000828                        0.9801980
EUKAP2_00012119 EUKAP2_00012119                        1.0000000
EUKAP2_00022484 EUKAP2_00022484                        0.9898990
EUKAP1_00001587 EUKAP1_00001587                        1.0000000
EUKAP2_00003841 EUKAP2_00003841                        0.9797980
EUKAP1_00002171 EUKAP1_00002171                        1.0000000
EUKAP1_00000777 EUKAP1_00000777                        0.9898990
EUKAP1_00008737 EUKAP1_00008737                        0.9898990
EUKAP1_00002035 EUKAP1_00002035                        0.9898990
EUKAP1_00000169 EUKAP1_00000169                        0.9898990
EUKAP2_00001740 EUKAP2_00001740                        1.0000000
EUKAP2_00009458 EUKAP2_00009458                        0.9900000
EUKAP2_00003831 EUKAP2_00003831                        1.0000000
EUKAP2_00022266 EUKAP2_00022266                        0.9800000
EUKAP2_00010014 EUKAP2_00010014                        1.0000000
EUKAP1_00057446 EUKAP1_00057446                        1.0000000
EUKAP300018830   EUKAP300018830                        0.9904762
EUKAP1_00064447 EUKAP1_00064447                        0.9800000
EUKAP2_00070726 EUKAP2_00070726                        0.9800000
EUKAP300156660   EUKAP300156660                        0.9696970
EUKAP300243013   EUKAP300243013                        0.9696970
EUKAP1_00194237 EUKAP1_00194237                        0.9800000
EUKAP300050198   EUKAP300050198                        1.0000000
EUKAP1_00392433 EUKAP1_00392433                        0.9898990
EUKAP301198149   EUKAP301198149                        0.9809524
EUKAP300118644   EUKAP300118644                        0.9797980
EUKAP300121790   EUKAP300121790                        0.9898990
                best_match:db_EUKA  count  family         family_name   genus
EUKAP2_00000044           AJ864477 672745   29007 Neocallimastigaceae      NA
EUKAP2_00000018           AJ549807 296011      NA                &lt;NA&gt;      NA
EUKAP1_00000465           HM002753  88949 1131492      Aspergillaceae    5073
EUKAP1_00000186           AB016173  54865      NA                &lt;NA&gt;      NA
EUKAP1_00000177           EU940024  47208 1503986         Epibryaceae 1206334
EUKAP1_00000039           AJ301700  53976      NA                &lt;NA&gt;      NA
EUKAP1_00000072           KM222205  51916  452563     Cladosporiaceae    5498
EUKAP1_00000459           KF816220  27165 1429050      Abrothallaceae  941766
EUKAP2_00000193           HQ585899  38985   29007 Neocallimastigaceae    4821
EUKAP1_00000329           AF331950  33742   41253        Dothideaceae   45096
EUKAP1_00000033             U42478  23999   55176       Sporormiaceae  265084
EUKAP2_00000191           AF287834  29946      NA                &lt;NA&gt;      NA
EUKAP2_00000095           AF338393  28009      NA                &lt;NA&gt;      NA
EUKAP1_00000206           KJ636040  16412   43219 Herpotrichiellaceae   82105
EUKAP1_00000011           EU940029  14375      NA                &lt;NA&gt;      NA
EUKAP1_00000092           AY245658  20587  474943     Cordycipitaceae   45234
EUKAP1_00001538           AB022386  11553      NA                &lt;NA&gt;      NA
EUKAP1_00000188           AJ232942  12889      NA                &lt;NA&gt;      NA
EUKAP2_00001219           AB021689  19101 1799696    Sporidiobolaceae      NA
EUKAP1_00000190           EU940029  11606 1503986         Epibryaceae 1206334
EUKAP2_00000008           AY123301  16620      NA                &lt;NA&gt;      NA
EUKAP1_00000085           AJ232942  10792      NA                &lt;NA&gt;      NA
EUKAP2_00001065           EU192362   6106  742845      Malasseziaceae   55193
EUKAP2_00001127           AY234179  13673 1884633     Cryptococcaceae    5206
EUKAP1_00000357           DQ325444  12545 1131492      Aspergillaceae    5073
EUKAP1_00003304           AY187065   8149      NA                &lt;NA&gt;      NA
EUKAP2_00002016           DQ536481   9184   29007 Neocallimastigaceae  324618
EUKAP1_00000811           EU940024   7630      NA                &lt;NA&gt;      NA
EUKAP1_00000713           AY541478   6456   43219 Herpotrichiellaceae      NA
EUKAP2_00001304           AY216871  12143      NA                &lt;NA&gt;      NA
EUKAP1_00000035           KJ636040   5634   43219 Herpotrichiellaceae   82105
EUKAP1_00000326           DQ862043   5200  148311     Melanconidaceae  148317
EUKAP1_00001471           DQ862056   6637    5117           Valsaceae   83174
EUKAP1_00000406           KX822310   5537 1233474     Trichomeriaceae 1758290
EUKAP1_00001769           AY544705   5697  110846      Pyronemataceae   47188
EUKAP1_00000362           AF294724   7237    5268      Ustilaginaceae      NA
EUKAP1_00004847           AF331950   4592      NA                &lt;NA&gt;      NA
EUKAP2_00001858           HM002765   5512  184208     Psathyrellaceae   71729
EUKAP2_00002179           HM002772   3955    4854     Mortierellaceae    4855
EUKAP1_00000828           AY544720   2665    5189        Ascobolaceae    5190
EUKAP2_00012119           AB001766   4394 1851551          Mrakiaceae      NA
EUKAP2_00022484           AY489693   3033      NA                &lt;NA&gt;      NA
EUKAP1_00001587           AF260408   2166   47181     Ascodesmidaceae   64163
EUKAP2_00003841           AJ549807   1780      NA                &lt;NA&gt;      NA
EUKAP1_00002171           AM495006   1430  146292      Verrucariaceae  869220
EUKAP1_00000777           AF064049   1958      NA                &lt;NA&gt;      NA
EUKAP1_00008737           GU214594   1601      NA                &lt;NA&gt;      NA
EUKAP1_00002035           AB007683   2319      NA                &lt;NA&gt;      NA
EUKAP1_00000169           AF331950   1319      NA                &lt;NA&gt;      NA
EUKAP2_00001740           AF294721   1328    5268      Ustilaginaceae      NA
EUKAP2_00009458           DQ536485    528  451449     Rhizophydiaceae   60186
EUKAP2_00003831           AF113414    893    4858     Basidiobolaceae    4859
EUKAP2_00022266           AB586076    408 1134080   Powellomycetaceae      NA
EUKAP2_00010014           FJ176814    424    5189        Ascobolaceae   47218
EUKAP1_00057446           EF689825    752  146292      Verrucariaceae      NA
EUKAP300018830            AF294724    161    5268      Ustilaginaceae      NA
EUKAP1_00064447           GU250354    242 1233474     Trichomeriaceae 1562575
EUKAP2_00070726           KM222205    152      NA                &lt;NA&gt;      NA
EUKAP300156660            EU940024     54      NA                &lt;NA&gt;      NA
EUKAP300243013            EU940024     37      NA                &lt;NA&gt;      NA
EUKAP1_00194237           EU343098     86      NA                &lt;NA&gt;      NA
EUKAP300050198            KF443200     26    5268      Ustilaginaceae   63261
EUKAP1_00392433           EF137361     51   93133  Mycosphaerellaceae  395590
EUKAP301198149          AB028189.1      9    5268      Ustilaginaceae      NA
EUKAP300118644            AJ232942      6      NA                &lt;NA&gt;      NA
EUKAP300121790            EU940024      7 1503986         Epibryaceae 1206334
                      genus_name match_count:db_EUKA      rank
EUKAP2_00000044             &lt;NA&gt;                   6    family
EUKAP2_00000018             &lt;NA&gt;                  13  subclass
EUKAP1_00000465      Penicillium                   2     genus
EUKAP1_00000186             &lt;NA&gt;                  13   no rank
EUKAP1_00000177         Epibryon                   1   species
EUKAP1_00000039             &lt;NA&gt;                   5   kingdom
EUKAP1_00000072     Cladosporium                   1   species
EUKAP1_00000459      Abrothallus                   2     genus
EUKAP2_00000193        Piromyces                   1   species
EUKAP1_00000329         Dothidea                   1   species
EUKAP1_00000033         Preussia                   1   species
EUKAP2_00000191             &lt;NA&gt;                  12 subphylum
EUKAP2_00000095             &lt;NA&gt;                  17 subphylum
EUKAP1_00000206 Cladophialophora                   1   species
EUKAP1_00000011             &lt;NA&gt;                   5     order
EUKAP1_00000092        Cordyceps                   1   species
EUKAP1_00001538             &lt;NA&gt;                   9   no rank
EUKAP1_00000188             &lt;NA&gt;                   5     order
EUKAP2_00001219             &lt;NA&gt;                   1    family
EUKAP1_00000190         Epibryon                   3     genus
EUKAP2_00000008             &lt;NA&gt;                  10     order
EUKAP1_00000085             &lt;NA&gt;                  18     order
EUKAP2_00001065       Malassezia                   1     genus
EUKAP2_00001127     Cryptococcus                   1   species
EUKAP1_00000357      Penicillium                   2     genus
EUKAP1_00003304             &lt;NA&gt;                  78   kingdom
EUKAP2_00002016       Cyllamyces                   1   species
EUKAP1_00000811             &lt;NA&gt;                  11     order
EUKAP1_00000713             &lt;NA&gt;                   5    family
EUKAP2_00001304             &lt;NA&gt;                   3     class
EUKAP1_00000035 Cladophialophora                   1   species
EUKAP1_00000326       Melanconis                   1     genus
EUKAP1_00001471            Valsa                   1   species
EUKAP1_00000406    Arthrocladium                   2     genus
EUKAP1_00001769      Cheilymenia                   1   species
EUKAP1_00000362             &lt;NA&gt;                   1    family
EUKAP1_00004847             &lt;NA&gt;                   8   no rank
EUKAP2_00001858      Psathyrella                   1   species
EUKAP2_00002179      Mortierella                   2     genus
EUKAP1_00000828        Ascobolus                   1     genus
EUKAP2_00012119             &lt;NA&gt;                   1    family
EUKAP2_00022484             &lt;NA&gt;                   5     class
EUKAP1_00001587       Lasiobolus                   1     genus
EUKAP2_00003841             &lt;NA&gt;                 163 subphylum
EUKAP1_00002171      Psoroglaena                   1   species
EUKAP1_00000777             &lt;NA&gt;                   7     class
EUKAP1_00008737             &lt;NA&gt;                   3   no rank
EUKAP1_00002035             &lt;NA&gt;                   3  subclass
EUKAP1_00000169             &lt;NA&gt;                   4   no rank
EUKAP2_00001740             &lt;NA&gt;                   1    family
EUKAP2_00009458     Rhizophydium                   1     genus
EUKAP2_00003831     Basidiobolus                   1     genus
EUKAP2_00022266             &lt;NA&gt;                   4    family
EUKAP2_00010014       Saccobolus                   1   species
EUKAP1_00057446             &lt;NA&gt;                   1    family
EUKAP300018830              &lt;NA&gt;                   6    family
EUKAP1_00064447       Bradymyces                   1   species
EUKAP2_00070726             &lt;NA&gt;                  31 subphylum
EUKAP300156660              &lt;NA&gt;                   4     order
EUKAP300243013              &lt;NA&gt;                  16     order
EUKAP1_00194237             &lt;NA&gt;                  33 subphylum
EUKAP300050198      Moesziomyces                   1   species
EUKAP1_00392433        Zasmidium                   1   species
EUKAP301198149              &lt;NA&gt;                   3    family
EUKAP300118644              &lt;NA&gt;                  22     order
EUKAP300121790          Epibryon                   1   species
                          scientific_name species
EUKAP2_00000044       Neocallimastigaceae      NA
EUKAP2_00000018         Lecanoromycetidae      NA
EUKAP1_00000465               Penicillium      NA
EUKAP1_00000186              leotiomyceta      NA
EUKAP1_00000177   Epibryon interlamellare 1206340
EUKAP1_00000039                     Fungi      NA
EUKAP1_00000072    Cladosporium sp. CB-20 1563333
EUKAP1_00000459               Abrothallus      NA
EUKAP2_00000193       Piromyces sp. PGL01  935217
EUKAP1_00000329         Dothidea sp. RWT7  154309
EUKAP1_00000033        Preussia lignicola   45137
EUKAP2_00000191           Agaricomycotina      NA
EUKAP2_00000095            Pezizomycotina      NA
EUKAP1_00000206  Cladophialophora scillae  470451
EUKAP1_00000011           Chaetothyriales      NA
EUKAP1_00000092     Cordyceps memorabilis   87750
EUKAP1_00001538              leotiomyceta      NA
EUKAP1_00000188           Chaetothyriales      NA
EUKAP2_00001219          Sporidiobolaceae      NA
EUKAP1_00000190                  Epibryon      NA
EUKAP2_00000008               Pucciniales      NA
EUKAP1_00000085           Chaetothyriales      NA
EUKAP2_00001065                Malassezia      NA
EUKAP2_00001127   Cryptococcus sp. AspoyC  228937
EUKAP1_00000357               Penicillium      NA
EUKAP1_00003304                     Fungi      NA
EUKAP2_00002016      Cyllamyces aberensis  324620
EUKAP1_00000811           Chaetothyriales      NA
EUKAP1_00000713       Herpotrichiellaceae      NA
EUKAP2_00001304        Microbotryomycetes      NA
EUKAP1_00000035  Cladophialophora scillae  470451
EUKAP1_00000326                Melanconis      NA
EUKAP1_00001471             Valsa ambiens  148335
EUKAP1_00000406             Arthrocladium      NA
EUKAP1_00001769     Cheilymenia stercorea   47189
EUKAP1_00000362            Ustilaginaceae      NA
EUKAP1_00004847              leotiomyceta      NA
EUKAP2_00001858       Psathyrella sp. D16  859368
EUKAP2_00002179               Mortierella      NA
EUKAP1_00000828                 Ascobolus      NA
EUKAP2_00012119                Mrakiaceae      NA
EUKAP2_00022484           Sordariomycetes      NA
EUKAP1_00001587                Lasiobolus      NA
EUKAP2_00003841            Pezizomycotina      NA
EUKAP1_00002171 Psoroglaena stigonemoides  869222
EUKAP1_00000777           Sordariomycetes      NA
EUKAP1_00008737              leotiomyceta      NA
EUKAP1_00002035         Hypocreomycetidae      NA
EUKAP1_00000169              leotiomyceta      NA
EUKAP2_00001740            Ustilaginaceae      NA
EUKAP2_00009458              Rhizophydium      NA
EUKAP2_00003831              Basidiobolus      NA
EUKAP2_00022266         Powellomycetaceae      NA
EUKAP2_00010014     Saccobolus dilutellus  406764
EUKAP1_00057446            Verrucariaceae      NA
EUKAP300018830             Ustilaginaceae      NA
EUKAP1_00064447        Bradymyces alpinus 1562577
EUKAP2_00070726            Pezizomycotina      NA
EUKAP300156660            Chaetothyriales      NA
EUKAP300243013            Chaetothyriales      NA
EUKAP1_00194237            Pezizomycotina      NA
EUKAP300050198       Moesziomyces aphidis   84754
EUKAP1_00392433         Zasmidium cellare  395010
EUKAP301198149             Ustilaginaceae      NA
EUKAP300118644            Chaetothyriales      NA
EUKAP300121790    Epibryon interlamellare 1206340
                                                                                                                                                                                                                                                       species_list:db_EUKA
EUKAP2_00000044                                                                                                                                                    ['Neocallimastix joyonii', 'Neocallimastix sp. YQ1', 'Neocallimastix frontalis', 'Orpinomyces sp. OUS1']
EUKAP2_00000018              ['Usnea florida', 'Pyxine farinosa', 'Cladia aggregata', 'Allocetraria madreporiformis', 'Lecidea plana', 'Anaptychia runcinata', 'Punctelia rudecta', 'Asahinea chrysantha', 'Nephroma bellum', 'Psilolechia lucida', 'Vahliella leucophaea']
EUKAP1_00000465                                                                                                                                                                                                                  ['Penicillium sp.', 'Penicillium sp. D01']
EUKAP1_00000186                                                      ['Monilinia laxa', 'Sclerotinia trifoliorum', 'Lophium mytilinum', 'Pseudogymnoascus pannorum', 'Thelebolus microsporus', 'Pleochaeta shiraiana', 'Sclerotinia sclerotiorum', 'Microidium phyllanthi']
EUKAP1_00000177                                                                                                                                                                                                                                 ['Epibryon interlamellare']
EUKAP1_00000039                                                                                                                                                        ['Rhizophagus fasciculatus', 'Alternaria alternariae', 'Clarireedia homoeocarpa', 'Pezoloma ericae']
EUKAP1_00000072                                                                                                                                                                                                                                  ['Cladosporium sp. CB-20']
EUKAP1_00000459                                                                                                                                                                                                                                   ['Abrothallus cladoniae']
EUKAP2_00000193                                                                                                                                                                                                                                     ['Piromyces sp. PGL01']
EUKAP1_00000329                                                                                                                                                                                                                                       ['Dothidea sp. RWT7']
EUKAP1_00000033                                                                                                                                                                                                                                      ['Preussia lignicola']
EUKAP2_00000191                                            ['Krasilnikovozyma sp.', 'Hygrophorus sordidus', 'Cystoderma amianthinum', 'Tricholoma matsutake', 'Lepista sordida', 'Pleurotus cornucopiae', 'Pholiota aff. astragalina PBM2975', 'Laccaria vinaceoavellanea']
EUKAP2_00000095 ['Sigmoidea prolifera', 'Rhizina undulata', 'Sphaerulina populicola', 'Orbilia sp. HOB-2016bf', 'Acidiella bohemica', 'Phaeoisariopsis griseola', 'Caloscypha fulgens', 'Hydnotrya cerebriformis', 'Phyllosticta capitalensis', 'Botryobambusa fusicoccum']
EUKAP1_00000206                                                                                                                                                                                                                                ['Cladophialophora scillae']
EUKAP1_00000011                                                                                                                                                      ['Epibryon hepaticola', 'Epibryon intercapillare', 'Epibryon sp. D TL-2012', 'Cyphellophora sessilis']
EUKAP1_00000092                                                                                                                                                                                                                                   ['Cordyceps memorabilis']
EUKAP1_00001538                                                                                              ['Lecanora cinereofusca', 'Peltula imbricata', 'Thamnogalla crombiei', 'Siphula decumbens', 'Siphula fastigiata', 'Peltula obscurans', 'Peltula boletiformis']
EUKAP1_00000188                                                                                                                                                                       ['Epibryon intercapillare', 'Cladophialophora mycetomatis', 'Epibryon sp. D TL-2012']
EUKAP2_00001219                                                                                                                                                                                                                                                          []
EUKAP1_00000190                                                                                                                                                                                ['Epibryon hepaticola', 'Epibryon intercapillare', 'Epibryon sp. D TL-2012']
EUKAP2_00000008                                                                                     ['Phragmidium sp. MB', 'Puccinia ursiniae', 'Puccinia smilacis', 'Phakopsora pachyrhizi', 'Diorchidium woodii', 'Pucciniastrum brachybotrydis', 'Hamaspora acutissima']
EUKAP1_00000085                                                                                           ['Epibryon hepaticola', 'Epibryon intercapillare', 'Epibryon interlamellare', 'Epibryon sp. D TL-2012', 'Epibryon sp. E TL-2012', 'Cladophialophora mycetomatis']
EUKAP2_00001065                                                                                                                                                                                                                                                          []
EUKAP2_00001127                                                                                                                                                                                                                                 ['Cryptococcus sp. AspoyC']
EUKAP1_00000357                                                                                                                                                                                                                             ['Penicillium sp. 5H1-M0-P8-2']
EUKAP1_00003304                                                                                                                                                                                                                                                          []
EUKAP2_00002016                                                                                                                                                                                                                                    ['Cyllamyces aberensis']
EUKAP1_00000811                                                               ['Epibryon hepaticola', 'Epibryon intercapillare', 'Epibryon interlamellare', 'Epibryon sp. D TL-2012', 'Epibryon sp. E TL-2012', 'Cladophialophora scillae', 'Cladophialophora mycetomatis']
EUKAP1_00000713                                                                                                                                                                                                                                  ['Capronia dactylotricha']
EUKAP2_00001304                                                                                                                                                                        ['Trigonosporomyces hylophilus', 'Rhodotorula sp. 1e', 'Leucosporidium intermedium']
EUKAP1_00000035                                                                                                                                                                                                                                ['Cladophialophora scillae']
EUKAP1_00000326                                                                                                                                                                                                                                                          []
EUKAP1_00001471                                                                                                                                                                                                                                           ['Valsa ambiens']
EUKAP1_00000406                                                                                                                                                                                                                                 ['Arthrocladium tropicale']
EUKAP1_00001769                                                                                                                                                                                                                                   ['Cheilymenia stercorea']
EUKAP1_00000362                                                                                                                                                                                                                                                          []
EUKAP1_00004847                                                                                        ['Dothidea sp. RWT7', 'Peltula imbricata', 'Peltula obscurans', 'Neoscytalidium dimidiatum', 'Thamnogalla crombiei', 'Anaptychia runcinata', 'Peltula boletiformis']
EUKAP2_00001858                                                                                                                                                                                                                                     ['Psathyrella sp. D16']
EUKAP2_00002179                                                                                                                                                                                                              ['Mortierella sp. D38', 'Mortierella sp. D34']
EUKAP1_00000828                                                                                                                                                                                                                                                          []
EUKAP2_00012119                                                                                                                                                                                                                                                          []
EUKAP2_00022484                                                                                                                                                    ['Clonostachys rosea', 'Stilbocrea macrostoma', 'Colletotrichum gloeosporioides', 'Endoxyla operculata']
EUKAP1_00001587                                                                                                                                                                                                                                                          []
EUKAP2_00003841                                                                                                                                                                                                                                                          []
EUKAP1_00002171                                                                                                                                                                                                                               ['Psoroglaena stigonemoides']
EUKAP1_00000777                                                                                               ['Obolarina dryophila', 'Monographella nivalis', 'Hyponectria buxi', 'Hypoxylon submonticulosum', 'Polystigma ochraceum', 'Diatrype sp. D09', 'Fusarium sp.']
EUKAP1_00008737                                                                                                                                                                                                                                   ['Staninwardia suttonii']
EUKAP1_00002035                                                                                                                                                                           ['Melanospora asymmetrica', 'Parascedosporium putredinis', 'Scedosporium boydii']
EUKAP1_00000169                                                                                                                                                                                  ['Neoscytalidium dimidiatum', 'Dothidea sp. RWT7', 'Anaptychia runcinata']
EUKAP2_00001740                                                                                                                                                                                                                                                          []
EUKAP2_00009458                                                                                                                                                                                                                                                          []
EUKAP2_00003831                                                                                                                                                                                                                                                          []
EUKAP2_00022266                                                                                                                                                                                                       ['Geranomyces variabilis', 'Geranomyces hawaiiensis']
EUKAP2_00010014                                                                                                                                                                                                                                   ['Saccobolus dilutellus']
EUKAP1_00057446                                                                                                                                                                                                                                                          []
EUKAP300018830                                                                                                                                                                                                              ['Ustilago filiformis', 'Moesziomyces aphidis']
EUKAP1_00064447                                                                                                                                                                                                                                      ['Bradymyces alpinus']
EUKAP2_00070726                                                                                                                                                                                                                                                          []
EUKAP300156660                                                                                                                                                 ['Epibryon intercapillare', 'Epibryon interlamellare', 'Cladophialophora scillae', 'Epibryon sp. D TL-2012']
EUKAP300243013             ['Epibryon hepaticola', 'Epibryon intercapillare', 'Exophiala prototropha', 'Epibryon sp. D TL-2012', 'Epibryon sp. E TL-2012', 'Cyphellophora sessilis', 'Cladophialophora scillae', 'Cladophialophora mycetomatis', 'Epibryon interlamellare']
EUKAP1_00194237                                                                                                                                                                                                                                                          []
EUKAP300050198                                                                                                                                                                                                                                     ['Moesziomyces aphidis']
EUKAP1_00392433                                                                                                                                                                                                                                       ['Zasmidium cellare']
EUKAP301198149                                                                                                                                                                                   ['Ustilago shiraiana', 'Ustilago filiformis', 'Tranzscheliella hypodytes']
EUKAP300118644                                                                                            ['Epibryon hepaticola', 'Epibryon intercapillare', 'Epibryon interlamellare', 'Epibryon sp. D TL-2012', 'Epibryon sp. E TL-2012', 'Cladophialophora mycetomatis']
EUKAP300121790                                                                                                                                                                                                                                  ['Epibryon interlamellare']
                             species_name   taxid
EUKAP2_00000044                      &lt;NA&gt;   29007
EUKAP2_00000018                      &lt;NA&gt;  388435
EUKAP1_00000465                      &lt;NA&gt;    5073
EUKAP1_00000186                      &lt;NA&gt;  716546
EUKAP1_00000177   Epibryon interlamellare 1206340
EUKAP1_00000039                      &lt;NA&gt;    4751
EUKAP1_00000072    Cladosporium sp. CB-20 1563333
EUKAP1_00000459                      &lt;NA&gt;  941766
EUKAP2_00000193       Piromyces sp. PGL01  935217
EUKAP1_00000329         Dothidea sp. RWT7  154309
EUKAP1_00000033        Preussia lignicola   45137
EUKAP2_00000191                      &lt;NA&gt;    5302
EUKAP2_00000095                      &lt;NA&gt;  147538
EUKAP1_00000206  Cladophialophora scillae  470451
EUKAP1_00000011                      &lt;NA&gt;   34395
EUKAP1_00000092     Cordyceps memorabilis   87750
EUKAP1_00001538                      &lt;NA&gt;  716546
EUKAP1_00000188                      &lt;NA&gt;   34395
EUKAP2_00001219                      &lt;NA&gt; 1799696
EUKAP1_00000190                      &lt;NA&gt; 1206334
EUKAP2_00000008                      &lt;NA&gt;    5258
EUKAP1_00000085                      &lt;NA&gt;   34395
EUKAP2_00001065                      &lt;NA&gt;   55193
EUKAP2_00001127   Cryptococcus sp. AspoyC  228937
EUKAP1_00000357                      &lt;NA&gt;    5073
EUKAP1_00003304                      &lt;NA&gt;    4751
EUKAP2_00002016      Cyllamyces aberensis  324620
EUKAP1_00000811                      &lt;NA&gt;   34395
EUKAP1_00000713                      &lt;NA&gt;   43219
EUKAP2_00001304                      &lt;NA&gt;  162481
EUKAP1_00000035  Cladophialophora scillae  470451
EUKAP1_00000326                      &lt;NA&gt;  148317
EUKAP1_00001471             Valsa ambiens  148335
EUKAP1_00000406                      &lt;NA&gt; 1758290
EUKAP1_00001769     Cheilymenia stercorea   47189
EUKAP1_00000362                      &lt;NA&gt;    5268
EUKAP1_00004847                      &lt;NA&gt;  716546
EUKAP2_00001858       Psathyrella sp. D16  859368
EUKAP2_00002179                      &lt;NA&gt;    4855
EUKAP1_00000828                      &lt;NA&gt;    5190
EUKAP2_00012119                      &lt;NA&gt; 1851551
EUKAP2_00022484                      &lt;NA&gt;  147550
EUKAP1_00001587                      &lt;NA&gt;   64163
EUKAP2_00003841                      &lt;NA&gt;  147538
EUKAP1_00002171 Psoroglaena stigonemoides  869222
EUKAP1_00000777                      &lt;NA&gt;  147550
EUKAP1_00008737                      &lt;NA&gt;  716546
EUKAP1_00002035                      &lt;NA&gt;  222543
EUKAP1_00000169                      &lt;NA&gt;  716546
EUKAP2_00001740                      &lt;NA&gt;    5268
EUKAP2_00009458                      &lt;NA&gt;   60186
EUKAP2_00003831                      &lt;NA&gt;    4859
EUKAP2_00022266                      &lt;NA&gt; 1134080
EUKAP2_00010014     Saccobolus dilutellus  406764
EUKAP1_00057446                      &lt;NA&gt;  146292
EUKAP300018830                       &lt;NA&gt;    5268
EUKAP1_00064447        Bradymyces alpinus 1562577
EUKAP2_00070726                      &lt;NA&gt;  147538
EUKAP300156660                       &lt;NA&gt;   34395
EUKAP300243013                       &lt;NA&gt;   34395
EUKAP1_00194237                      &lt;NA&gt;  147538
EUKAP300050198       Moesziomyces aphidis   84754
EUKAP1_00392433         Zasmidium cellare  395010
EUKAP301198149                       &lt;NA&gt;    5268
EUKAP300118644                       &lt;NA&gt;   34395
EUKAP300121790    Epibryon interlamellare 1206340
                                                                                                                 sequence
EUKAP2_00000044  ataacgaacgagaccttaacctgctaaatagttacgcgaatgttttctattcgtggtttaacttcttagagggactatagatttttaatctatggaagtttgag
EUKAP2_00000018       ataacgaacgagaccttaacctgctaaatagccaggtcagctttggctggccgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000465        ataacgaacgagacctcggcccttaaatagcccggtccgcatttgcgggccgctggcttcttagggggactatcggctcaagccgatggaagtgcgcg
EUKAP1_00000186       ataacgaacgagaccttaacctgctaaatagcccggctagctttggctggtcgctggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000177       ataacgaacgagaccttgacctgctaaatagccagattgacttttgttggtcgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00000039       ataacgaacgagaccttaacctgctaaatagccaggctagctttggctggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000072       ataacgaacgagaccttaacctgctaaatagccaggcccgctttggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000459       ataacgaacgagaccttaacctgctaaatagccaggtcagctttggctgatcgcaggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP2_00000193     ataacgaacgagaccttaacctgctaaatagttacgcgaattttttattcgtggctaacttcttagagggactatagatttttaatctatggaagtttgag
EUKAP1_00000329       ataacgaacgagaccttaacctgctaaatagcccggccagctttggctggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000033       ataacgaacgagaccttaacctgctaaatagccgggctagctttggctggtcgtcggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP2_00000191      ataacgaacgagaccttaacctgctaaatagccaggccggctttcgctggtcgccggcttcttagagggactgtcagcgtctagctgacggaagtttgag
EUKAP2_00000095       ataacgaacgagaccttaacctgctaaatagcccggcccgctttggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000206       ataacgaacgagaccttgacctgctaaatagcccgattgacttttgtcggtcgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00000011       ataacgaacgagaccttgacctgctaaatagcccggctgacttttgttggccgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00000092       ataacgaacgagaccttaacctgctaaatagcccgtattgctttggcagtacgctggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00001538       ataacgaacgagaccttaacctgctaaatagccaggctagccttggctggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000188       ataacgaacgagaccttgacctgctaaatagccaggttgacttttgtcggccgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP2_00001219      ataacgaacgagaccttaacctgctaaatagaccagtcgactttggttgactgctgtcttcttagagggactatcagcgtttagctgatggaagtttgag
EUKAP1_00000190       ataacgaacgagaccttgacctgctaaatagccaggctgactttggttggccgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP2_00000008      ataacgaacgagaccttctcctgctaaatagtccagctggctacggctggctgctgacttcttagagggactatcaacgtttagttgatggaagttggag
EUKAP1_00000085       ataacgaacgagaccttgacctgctaaatagcccggttgacttttgttgaccgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP2_00001065      ataacgaacgagaccttaacctgctaaatagcccagtcgactatggttggctgctggcttcttagagggactattggcgtttagccaatggaagtttgag
EUKAP2_00001127      ataacgaacgagaccttaacctgctaaatagtcaggccggcttcggctggtcgtcgacttcttagagggactgtcggcgtttagccgacggaagtttgag
EUKAP1_00000357        ataacgaacgagacctcggcccttaaatagcccggtccgcatttgcgggccgctggcttcttaaggggactatcggctcaagccgatggaagtgcgcg
EUKAP1_00003304       ataacgaacgagaccttcacctactaaatagcccggctagctttggctggtcgctggcttcttagagggactatcggctcaagccgatggaagttggag
EUKAP2_00002016     ataacgaacgagaccttaacctgctaaatagttacgcgaatttttaattcgtggctaacttcttagagggactatagatttttaatctatggaagtttgag
EUKAP1_00000811       ataacgaacgagaccttgacctgctaaatagccagcttgacttttgttgggcgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00000713       ataacgaacgagaccttgacctgctaaatagccaggttcacttttgtgggccgccggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP2_00001304      ataacgaacgagaccttaacctgctaaatagaccagccgactttggttagctgctgtcttcttagagggactatcagcgtttagctgatggaagtttgag
EUKAP1_00000035       ataacgaacgagaccttgacctgctaaatagcccgattgacttttgtcggtcgctggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00000326       ataacgaacgagaccttaacctgctaaatagcccgttccgctcaggcggaacgctggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00001471       ataacgaacgagaccttaacctgctaaatagcccggcccgcctaggcgggtcgctggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000406       ataacgaacgagaccttgacctgctaaatagcccaactcacttttgtgggttgctggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP1_00001769     ataacgaacgagaccttaacctgctaaatagccaggcccgcttttgcgggtcgccggcttcttagagggactatcggatttcaagtcgatggaagtttgag
EUKAP1_00000362 ataacgaacgagaccttgacctgctaaatagacgggttgacattttgttggccccttatgtcttcttagagggacaatcgaccgtctaggtgatggaggcaaaag
EUKAP1_00004847       ataacgaacgagaccttaacctgctaaatagcccggctagctttggctggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP2_00001858      ataacgaacgagaccttaacctgctaaatagccaggccggcttttgctggtcgccggcttcttagagggactgtcagcgtctagctgacggaagtttgag
EUKAP2_00002179      ttaacgaacgagaccttaacctgctaaatagttaggccaacgtttgttggtcgtcaacttcttagagggactattgactattagtcaatggaagtttgag
EUKAP1_00000828     ataacgaacgagaccttaacctgctaaatagccaggcctgcttttgcaggtcgcgggcttcttagagggactatcgggttctaaaccgatggaagtttgag
EUKAP2_00012119      ataacgaacgagaccttaacctgctaaatagccaggccggcttttgctggtcgccggcttcttagagggactatcagcatctagctgatggaagtttgag
EUKAP2_00022484       ataacgaacgagaccttaacctgctaactagcccgtattgctttggcagtacgctggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00001587     ataacgaacgagaccttaacctgctaaatagaccggcccgcgtttgcgggtcgctgtcttcttagagggactatcggatttcaagacgatggaagtttgag
EUKAP2_00003841       ataacgaacgagaccttaacttgctaaatagccaggtcagctttggctggccgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00002171       ttaacgaacgagaccttgacttactaactagcccgcctgaccttggttgggtgctggcttcttagaaggacttttggctcaagccaaaggaagtacgag
EUKAP1_00000777       ataacgaacgagaccttaacctgctaaatagcccgtattgctttggcagtacgctggcttcttagagggactatccgctcaagcggatggaagtttgag
EUKAP1_00008737       ataacgaacgagaccttaacctgctaaatagccaggcccgcttcggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00002035       ataacgaacgagaccttaacctgctaaatagcccgtactgctttggcagttcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP1_00000169       ataacgaacgagaccttaacctactaaatagcccggccagctttggctggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP2_00001740 ataacgaacgagaccttgacctgctaaatagacgggttgacattttgttggccccttatgtcttcttagagggactatcgaccgtctaggtgatggaggcaaaag
EUKAP2_00009458      ttaacgaacgagaccttaacctgctaaatagttacataaactttggtttatgattaacttcttagagggactatggacttttagtctatggaagtttgag
EUKAP2_00003831    ataacgaacgagaccttaacctgctaaatagttacgtttacctttgtgtagacggacaacttcttagagggactgctgatgtttaatcagtggaagtttgag
EUKAP2_00022266      ttaacgaacgagaccttaacctgctaaatagttacgttaactttggttgacggctaacttcttagagggactatggatgtttaatccatggaagtttgag
EUKAP2_00010014     ataacgaacgagaccttaacctgctaaatagacaggcttacttttgtaggtcgcagtcttcttagagggactatcgggttctaaaccgatggaagtttgag
EUKAP1_00057446       ttaacgaacgagaccttgacctgctaaatagcccgttcgactttggttggacgctggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP300018830  ataacgaacgagaccttgacctgctaaatagacgggttgacattttgttggccccttatgtcttcttagagggacaatcgaccgtctaggtgatggaggcaagag
EUKAP1_00064447       ataacgaacgagaccttgacctgctaaatagccccattcgctccggcggatggctggcttcttagagggacttttggctcaagccaatggaagtacgag
EUKAP2_00070726       ataacgagcgagaccttaacctgctaaatagccaggcccgctttggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP300156660        ataacgaacgagaccttgacctgctaaatagctagattgacttttgttggtcgccagcttcttagagggacttttggctcaagccaatggaagtaagag
EUKAP300243013        ataacgaacgagaccttgacctgctaaatagccagcttgacttttgttgggcgccggcttcttagagggacttttggctcaagccaatggaagtaagag
EUKAP1_00194237       ataacgaacgggaccttaacctgctaaatagccaggcccgctttggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP300050198  ataacgaacgagaccttgacctgctaaatagacgggttgacattttgttggccccttatgtcttcttagagggactatcgaccgtctaggtgatggaggcaagag
EUKAP1_00392433       ataacgaacgagaccttaacctgctaagtagccaggcccgctttggcgggtcgccggcttcttagagggactatcggctcaagccgatggaagtttgag
EUKAP301198149  ataacgaacgagaccttgacctgctaaatagacgggttgacattttgttggccccttatgtcttcttagagggacaatcgaacgtctagttgatggaggcaagag
EUKAP300118644        ataacgaacgagaccttgacctgctaaatagccaggttgacttttgtcggccgccggcttcttagagggacttttggctcaagccaatggaagtaagag
EUKAP300121790        ataacgaacgagaccttgacctgctaaatagccagattgacttttgttggtcgccggcttcttagagggacttttggctcaagccaatggaagtaagag
                sequence_type is_spermatophyta
EUKAP2_00000044        EUKA02            FALSE
EUKAP2_00000018        EUKA02            FALSE
EUKAP1_00000465        EUKA02            FALSE
EUKAP1_00000186        EUKA02            FALSE
EUKAP1_00000177        EUKA02            FALSE
EUKAP1_00000039        EUKA02            FALSE
EUKAP1_00000072        EUKA02            FALSE
EUKAP1_00000459        EUKA02            FALSE
EUKAP2_00000193        EUKA02            FALSE
EUKAP1_00000329        EUKA02            FALSE
EUKAP1_00000033        EUKA02            FALSE
EUKAP2_00000191        EUKA02            FALSE
EUKAP2_00000095        EUKA02            FALSE
EUKAP1_00000206        EUKA02            FALSE
EUKAP1_00000011        EUKA02            FALSE
EUKAP1_00000092        EUKA02            FALSE
EUKAP1_00001538        EUKA02            FALSE
EUKAP1_00000188        EUKA02            FALSE
EUKAP2_00001219        EUKA02            FALSE
EUKAP1_00000190        EUKA02            FALSE
EUKAP2_00000008        EUKA02            FALSE
EUKAP1_00000085        EUKA02            FALSE
EUKAP2_00001065        EUKA02            FALSE
EUKAP2_00001127        EUKA02            FALSE
EUKAP1_00000357        EUKA02            FALSE
EUKAP1_00003304        EUKA02            FALSE
EUKAP2_00002016        EUKA02            FALSE
EUKAP1_00000811        EUKA02            FALSE
EUKAP1_00000713        EUKA02            FALSE
EUKAP2_00001304        EUKA02            FALSE
EUKAP1_00000035        EUKA02            FALSE
EUKAP1_00000326        EUKA02            FALSE
EUKAP1_00001471        EUKA02            FALSE
EUKAP1_00000406        EUKA02            FALSE
EUKAP1_00001769        EUKA02            FALSE
EUKAP1_00000362        EUKA02            FALSE
EUKAP1_00004847        EUKA02            FALSE
EUKAP2_00001858        EUKA02            FALSE
EUKAP2_00002179        EUKA02            FALSE
EUKAP1_00000828        EUKA02            FALSE
EUKAP2_00012119        EUKA02            FALSE
EUKAP2_00022484        EUKA02            FALSE
EUKAP1_00001587        EUKA02            FALSE
EUKAP2_00003841        EUKA02            FALSE
EUKAP1_00002171        EUKA02            FALSE
EUKAP1_00000777        EUKA02            FALSE
EUKAP1_00008737        EUKA02            FALSE
EUKAP1_00002035        EUKA02            FALSE
EUKAP1_00000169        EUKA02            FALSE
EUKAP2_00001740        EUKA02            FALSE
EUKAP2_00009458        EUKA02            FALSE
EUKAP2_00003831        EUKA02            FALSE
EUKAP2_00022266        EUKA02            FALSE
EUKAP2_00010014        EUKA02            FALSE
EUKAP1_00057446        EUKA02            FALSE
EUKAP300018830         EUKA02            FALSE
EUKAP1_00064447        EUKA02            FALSE
EUKAP2_00070726        EUKA02            FALSE
EUKAP300156660         EUKA02            FALSE
EUKAP300243013         EUKA02            FALSE
EUKAP1_00194237        EUKA02            FALSE
EUKAP300050198         EUKA02            FALSE
EUKAP1_00392433        EUKA02            FALSE
EUKAP301198149         EUKA02            FALSE
EUKAP300118644         EUKA02            FALSE
EUKAP300121790         EUKA02            FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>to_keep <span class="ot">&lt;-</span> EUKA02.merged4<span class="sc">@</span>motus<span class="sc">$</span><span class="st">`</span><span class="at">best_identity:db_EUKA</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="fl">0.95</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(to_keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>to_keep
TRUE 
  92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>EUKA02.merged4<span class="sc">@</span>motus <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>to_keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] id                    definition            best_identity:db_EUKA
 [4] best_match:db_EUKA    count                 family               
 [7] family_name           genus                 genus_name           
[10] match_count:db_EUKA   rank                  scientific_name      
[13] species               species_list:db_EUKA  species_name         
[16] taxid                 sequence              sequence_type        
[19] is_spermatophyta     
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>EUKA02.final <span class="ot">&lt;-</span> EUKA02.merged4[,<span class="fu">which</span>(to_keep)]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>EUKA02.final<span class="sc">@</span>reads <span class="ot">&lt;-</span> <span class="fu">decostand</span>(EUKA02.final<span class="sc">@</span>reads,<span class="at">method =</span> <span class="st">"total"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="saving-the-filtered-dataset" class="level1">
<h1>Saving the filtered dataset</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">motus</span>(EUKA02.final), </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"Data/Faeces/FE.Eukaryota.samples.motus.csv"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">samples</span>(EUKA02.final), </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"Data/Faeces/FE.Eukaryota.samples.samples.csv"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">reads</span>(EUKA02.final), </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">"Data/Faeces/FE.Eukaryota.samples.reads.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Wickham2016-vl" class="csl-entry" role="doc-biblioentry">
Wickham, H., 2016. <a href="https://ggplot2.tidyverse.org"><span class="nocase">ggplot2: Elegant Graphics for Data Analysis</span></a>. Springer-Verlag New York.
</div>
<div id="ref-Wickham2019-ra" class="csl-entry" role="doc-biblioentry">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T., Miller, E., Bache, S., Müller, K., Ooms, J., Robinson, D., Seidel, D., Spinu, V., Takahashi, K., Vaughan, D., Wilke, C., Woo, K., Yutani, H., 2019. <span class="nocase">Welcome to the tidyverse</span>. Journal of open source software 4, 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>